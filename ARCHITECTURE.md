# Architecture Documentation

## ğŸ—ï¸ System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CLIENT LAYER                             â”‚
â”‚  (Web App, Mobile App, Third-party Services)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚ HTTP/HTTPS
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      GIN HTTP ROUTER                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Global Middleware                                        â”‚  â”‚
â”‚  â”‚  â€¢ CORS                                                   â”‚  â”‚
â”‚  â”‚  â€¢ Recovery                                               â”‚  â”‚
â”‚  â”‚  â€¢ Logger                                                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ROUTE HANDLERS                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  /api/users      â”‚          â”‚  /api/admins     â”‚            â”‚
â”‚  â”‚  â€¢ register      â”‚          â”‚  â€¢ login         â”‚            â”‚
â”‚  â”‚  â€¢ login         â”‚          â”‚  â€¢ CRUD ops      â”‚            â”‚
â”‚  â”‚  â€¢ profile       â”‚          â”‚  â€¢ permissions   â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MIDDLEWARE LAYER                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Authentication Middleware                                â”‚  â”‚
â”‚  â”‚  â€¢ JWT Validation                                         â”‚  â”‚
â”‚  â”‚  â€¢ Token Parsing                                          â”‚  â”‚
â”‚  â”‚  â€¢ Entity Extraction                                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Authorization Middleware                                 â”‚  â”‚
â”‚  â”‚  â€¢ Entity Type Check (User/Admin)                        â”‚  â”‚
â”‚  â”‚  â€¢ Permission Verification                                â”‚  â”‚
â”‚  â”‚  â€¢ Role-based Access Control                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CONTROLLER LAYER                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  UserController  â”‚          â”‚  AdminController â”‚            â”‚
â”‚  â”‚  â€¢ Request       â”‚          â”‚  â€¢ Request       â”‚            â”‚
â”‚  â”‚    Validation    â”‚          â”‚    Validation    â”‚            â”‚
â”‚  â”‚  â€¢ Response      â”‚          â”‚  â€¢ Response      â”‚            â”‚
â”‚  â”‚    Formatting    â”‚          â”‚    Formatting    â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     SERVICE LAYER                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  UserService     â”‚          â”‚  AdminService    â”‚            â”‚
â”‚  â”‚  â€¢ Business      â”‚          â”‚  â€¢ Business      â”‚            â”‚
â”‚  â”‚    Logic         â”‚          â”‚    Logic         â”‚            â”‚
â”‚  â”‚  â€¢ Validation    â”‚          â”‚  â€¢ Validation    â”‚            â”‚
â”‚  â”‚  â€¢ Orchestration â”‚          â”‚  â€¢ Orchestration â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   REPOSITORY LAYER                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  UserRepository  â”‚          â”‚  AdminRepository â”‚            â”‚
â”‚  â”‚  â€¢ CRUD          â”‚          â”‚  â€¢ CRUD          â”‚            â”‚
â”‚  â”‚  â€¢ Queries       â”‚          â”‚  â€¢ Queries       â”‚            â”‚
â”‚  â”‚  â€¢ Pagination    â”‚          â”‚  â€¢ Pagination    â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      DATABASE LAYER                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  GORM (ORM)                                               â”‚  â”‚
â”‚  â”‚  â€¢ Connection Pool                                        â”‚  â”‚
â”‚  â”‚  â€¢ Query Builder                                          â”‚  â”‚
â”‚  â”‚  â€¢ Migrations                                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                             â”‚                                    â”‚
â”‚                             â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  PostgreSQL Database                                      â”‚  â”‚
â”‚  â”‚  â€¢ users                                                  â”‚  â”‚
â”‚  â”‚  â€¢ admins                                                 â”‚  â”‚
â”‚  â”‚  â€¢ roles                                                  â”‚  â”‚
â”‚  â”‚  â€¢ permissions                                            â”‚  â”‚
â”‚  â”‚  â€¢ role_permissions                                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Data Flow Diagrams

### User Registration Flow

```
Client                Controller           Service              Repository         Database
  â”‚                       â”‚                   â”‚                     â”‚                 â”‚
  â”œâ”€POST /registerâ”€â”€â”€â”€â”€â”€>â”‚                   â”‚                     â”‚                 â”‚
  â”‚                       â”‚                   â”‚                     â”‚                 â”‚
  â”‚                       â”œâ”€Validate Inputâ”€â”€â”€>â”‚                     â”‚                 â”‚
  â”‚                       â”‚                   â”‚                     â”‚                 â”‚
  â”‚                       â”‚                   â”œâ”€Check Email Existsâ”€>â”‚                 â”‚
  â”‚                       â”‚                   â”‚                     â”‚                 â”‚
  â”‚                       â”‚                   â”‚                     â”œâ”€SELECT * FROMâ”€>â”‚
  â”‚                       â”‚                   â”‚                     â”‚   users        â”‚
  â”‚                       â”‚                   â”‚                     â”‚<â”€â”€â”€â”€Resultâ”€â”€â”€â”€â”€â”¤
  â”‚                       â”‚                   â”‚<â”€â”€â”€â”€Not Foundâ”€â”€â”€â”€â”€â”€â”¤                 â”‚
  â”‚                       â”‚                   â”‚                     â”‚                 â”‚
  â”‚                       â”‚                   â”œâ”€Hash Passwordâ”€â”€â”€â”€â”€â”€>â”‚                 â”‚
  â”‚                       â”‚                   â”‚                     â”‚                 â”‚
  â”‚                       â”‚                   â”œâ”€Create Userâ”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
  â”‚                       â”‚                   â”‚                     â”‚                 â”‚
  â”‚                       â”‚                   â”‚                     â”œâ”€INSERT INTOâ”€â”€â”€>â”‚
  â”‚                       â”‚                   â”‚                     â”‚   users        â”‚
  â”‚                       â”‚                   â”‚                     â”‚<â”€â”€â”€â”€Successâ”€â”€â”€â”€â”¤
  â”‚                       â”‚                   â”‚<â”€â”€â”€â”€User Objectâ”€â”€â”€â”€â”¤                 â”‚
  â”‚                       â”‚<â”€â”€User Createdâ”€â”€â”€â”€â”¤                     â”‚                 â”‚
  â”‚<â”€â”€201 Createdâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚                     â”‚                 â”‚
  â”‚   {user data}         â”‚                   â”‚                     â”‚                 â”‚
```

### Admin Login with Permission Check Flow

```
Client              Controller         Service          Repository       Database
  â”‚                     â”‚                 â”‚                  â”‚               â”‚
  â”œâ”€POST /loginâ”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚                  â”‚               â”‚
  â”‚  {credentials}      â”‚                 â”‚                  â”‚               â”‚
  â”‚                     â”‚                 â”‚                  â”‚               â”‚
  â”‚                     â”œâ”€Validateâ”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚               â”‚
  â”‚                     â”‚                 â”‚                  â”‚               â”‚
  â”‚                     â”‚                 â”œâ”€Find Adminâ”€â”€â”€â”€â”€â”€>â”‚               â”‚
  â”‚                     â”‚                 â”‚                  â”‚               â”‚
  â”‚                     â”‚                 â”‚                  â”œâ”€SELECT * â”€â”€â”€â”€>â”‚
  â”‚                     â”‚                 â”‚                  â”‚  FROM admins  â”‚
  â”‚                     â”‚                 â”‚                  â”‚  JOIN roles   â”‚
  â”‚                     â”‚                 â”‚                  â”‚<â”€â”€Admin+Roleâ”€â”€â”¤
  â”‚                     â”‚                 â”‚<â”€Admin Objectâ”€â”€â”€â”€â”¤               â”‚
  â”‚                     â”‚                 â”‚                  â”‚               â”‚
  â”‚                     â”‚                 â”œâ”€Verify Passwordâ”€â”€>â”‚               â”‚
  â”‚                     â”‚                 â”‚                  â”‚               â”‚
  â”‚                     â”‚                 â”œâ”€Generate JWTâ”€â”€â”€â”€>â”‚               â”‚
  â”‚                     â”‚                 â”‚  (with role_id)  â”‚               â”‚
  â”‚                     â”‚<â”€Tokensâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚               â”‚
  â”‚<â”€200 OKâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                 â”‚                  â”‚               â”‚
  â”‚  {access_token,     â”‚                 â”‚                  â”‚               â”‚
  â”‚   refresh_token}    â”‚                 â”‚                  â”‚               â”‚
```

### Authenticated Request with Permission Check

```
Client          Middleware        Controller      Service       Repository
  â”‚                 â”‚                 â”‚               â”‚              â”‚
  â”œâ”€GET /adminsâ”€â”€â”€â”€>â”‚                 â”‚               â”‚              â”‚
  â”‚  Bearer token   â”‚                 â”‚               â”‚              â”‚
  â”‚                 â”‚                 â”‚               â”‚              â”‚
  â”‚                 â”œâ”€Validate JWTâ”€â”€â”€>â”‚               â”‚              â”‚
  â”‚                 â”‚                 â”‚               â”‚              â”‚
  â”‚                 â”œâ”€Extract Claimsâ”€â”€>â”‚               â”‚              â”‚
  â”‚                 â”‚  (entity_id,    â”‚               â”‚              â”‚
  â”‚                 â”‚   entity_type,  â”‚               â”‚              â”‚
  â”‚                 â”‚   role_id)      â”‚               â”‚              â”‚
  â”‚                 â”‚                 â”‚               â”‚              â”‚
  â”‚                 â”œâ”€Check Entityâ”€â”€â”€â”€>â”‚               â”‚              â”‚
  â”‚                 â”‚  Type = Admin   â”‚               â”‚              â”‚
  â”‚                 â”‚                 â”‚               â”‚              â”‚
  â”‚                 â”œâ”€Load Roleâ”€â”€â”€â”€â”€â”€â”€>â”‚               â”‚              â”‚
  â”‚                 â”‚  Permissions    â”‚               â”‚              â”‚
  â”‚                 â”‚                 â”‚               â”‚              â”‚
  â”‚                 â”œâ”€Verifyâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚               â”‚              â”‚
  â”‚                 â”‚  Permission     â”‚               â”‚              â”‚
  â”‚                 â”‚  "admins.view"  â”‚               â”‚              â”‚
  â”‚                 â”‚                 â”‚               â”‚              â”‚
  â”‚                 â”‚<â”€Authorizedâ”€â”€â”€â”€â”€â”¤               â”‚              â”‚
  â”‚                 â”‚                 â”‚               â”‚              â”‚
  â”‚                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚               â”‚              â”‚
  â”‚                 â”‚                 â”‚               â”‚              â”‚
  â”‚                 â”‚                 â”œâ”€List Adminsâ”€â”€>â”‚              â”‚
  â”‚                 â”‚                 â”‚               â”‚              â”‚
  â”‚                 â”‚                 â”‚               â”œâ”€Query DBâ”€â”€â”€â”€>â”‚
  â”‚                 â”‚                 â”‚               â”‚              â”‚
  â”‚                 â”‚                 â”‚               â”‚<â”€Resultsâ”€â”€â”€â”€â”€â”¤
  â”‚                 â”‚                 â”‚<â”€Admin Listâ”€â”€â”€â”¤              â”‚
  â”‚                 â”‚<â”€Responseâ”€â”€â”€â”€â”€â”€â”€â”¤               â”‚              â”‚
  â”‚<â”€200 OKâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                 â”‚               â”‚              â”‚
  â”‚  {admins, meta} â”‚                 â”‚               â”‚              â”‚
```

## ğŸ—„ï¸ Database Schema

```sql
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         USERS TABLE                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id           â”‚ UUID         â”‚ PRIMARY KEY  â”‚                   â”‚
â”‚ email        â”‚ VARCHAR(255) â”‚ UNIQUE       â”‚ NOT NULL          â”‚
â”‚ password     â”‚ VARCHAR(255) â”‚              â”‚ NOT NULL (hashed) â”‚
â”‚ first_name   â”‚ VARCHAR(100) â”‚              â”‚                   â”‚
â”‚ last_name    â”‚ VARCHAR(100) â”‚              â”‚                   â”‚
â”‚ is_active    â”‚ BOOLEAN      â”‚              â”‚ DEFAULT true      â”‚
â”‚ created_at   â”‚ TIMESTAMP    â”‚              â”‚                   â”‚
â”‚ updated_at   â”‚ TIMESTAMP    â”‚              â”‚                   â”‚
â”‚ deleted_at   â”‚ TIMESTAMP    â”‚              â”‚ NULL (soft del)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ADMINS TABLE                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id           â”‚ UUID         â”‚ PRIMARY KEY  â”‚                   â”‚
â”‚ email        â”‚ VARCHAR(255) â”‚ UNIQUE       â”‚ NOT NULL          â”‚
â”‚ password     â”‚ VARCHAR(255) â”‚              â”‚ NOT NULL (hashed) â”‚
â”‚ first_name   â”‚ VARCHAR(100) â”‚              â”‚                   â”‚
â”‚ last_name    â”‚ VARCHAR(100) â”‚              â”‚                   â”‚
â”‚ role_id      â”‚ UUID         â”‚ FOREIGN KEY  â”‚ â†’ roles(id)       â”‚
â”‚ is_active    â”‚ BOOLEAN      â”‚              â”‚ DEFAULT true      â”‚
â”‚ created_at   â”‚ TIMESTAMP    â”‚              â”‚                   â”‚
â”‚ updated_at   â”‚ TIMESTAMP    â”‚              â”‚                   â”‚
â”‚ deleted_at   â”‚ TIMESTAMP    â”‚              â”‚ NULL (soft del)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ROLES TABLE                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id           â”‚ UUID         â”‚ PRIMARY KEY  â”‚                   â”‚
â”‚ name         â”‚ VARCHAR(100) â”‚ UNIQUE       â”‚ NOT NULL          â”‚
â”‚ description  â”‚ VARCHAR(255) â”‚              â”‚                   â”‚
â”‚ created_at   â”‚ TIMESTAMP    â”‚              â”‚                   â”‚
â”‚ updated_at   â”‚ TIMESTAMP    â”‚              â”‚                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      PERMISSIONS TABLE                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id           â”‚ UUID         â”‚ PRIMARY KEY  â”‚                   â”‚
â”‚ name         â”‚ VARCHAR(100) â”‚ UNIQUE       â”‚ NOT NULL          â”‚
â”‚ description  â”‚ VARCHAR(255) â”‚              â”‚                   â”‚
â”‚ created_at   â”‚ TIMESTAMP    â”‚              â”‚                   â”‚
â”‚ updated_at   â”‚ TIMESTAMP    â”‚              â”‚                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ROLE_PERMISSIONS TABLE                         â”‚
â”‚                    (Many-to-Many Join)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ role_id      â”‚ UUID         â”‚ FOREIGN KEY  â”‚ â†’ roles(id)       â”‚
â”‚ permission_idâ”‚ UUID         â”‚ FOREIGN KEY  â”‚ â†’ permissions(id) â”‚
â”‚              â”‚              â”‚ PRIMARY KEY  â”‚ (role_id,         â”‚
â”‚              â”‚              â”‚              â”‚  permission_id)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Relationships

```
roles (1) â”€â”€â”€â”€â”€â”€< (N) admins
  â”‚
  â”‚ (M)
  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€< role_permissions >â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                                         â”‚
  â”‚                                         â”‚ (M)
  â”‚                                         â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> permissions (N)
```

## ğŸ” JWT Token Structure

### Access Token Claims
```json
{
  "entity_id": "uuid-string",
  "entity_type": "user" | "admin",
  "role_id": "uuid-string",  // Only for admins
  "token_type": "access",
  "exp": 1699999999,
  "iat": 1699996399
}
```

### Refresh Token Claims
```json
{
  "entity_id": "uuid-string",
  "entity_type": "user" | "admin",
  "role_id": "uuid-string",  // Only for admins
  "token_type": "refresh",
  "exp": 1700604199,
  "iat": 1699996399
}
```

## ğŸ“¦ Module Dependencies

```
main.go
  â”œâ”€â”€ config
  â”œâ”€â”€ database
  â”‚   â””â”€â”€ models
  â”œâ”€â”€ middleware
  â”‚   â”œâ”€â”€ utils (jwt, response)
  â”‚   â”œâ”€â”€ database
  â”‚   â””â”€â”€ models
  â””â”€â”€ api
      â”œâ”€â”€ users
      â”‚   â”œâ”€â”€ repository (database, models, utils)
      â”‚   â”œâ”€â”€ service (repository, utils, models)
      â”‚   â”œâ”€â”€ controller (service, utils)
      â”‚   â””â”€â”€ routes (controller, middleware)
      â””â”€â”€ admins
          â”œâ”€â”€ repository (database, models, utils)
          â”œâ”€â”€ service (repository, utils, models)
          â”œâ”€â”€ controller (service, utils)
          â””â”€â”€ routes (controller, middleware)
```

## ğŸ¯ Design Principles

### 1. **Separation of Concerns**
- Each layer has a single responsibility
- Controllers handle HTTP
- Services handle business logic
- Repositories handle data access

### 2. **Dependency Inversion**
- Depend on interfaces, not implementations
- Easy to mock for testing
- Flexible to swap implementations

### 3. **Single Responsibility**
- Each file/struct has one clear purpose
- Easy to understand and maintain

### 4. **DRY (Don't Repeat Yourself)**
- Unified response structure
- Reusable middleware
- Shared utilities

### 5. **Security by Design**
- Authentication required by default
- Permission checks at route level
- Password hashing
- JWT token validation

## ğŸš€ Scalability Patterns

### Horizontal Scaling
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   API       â”‚     â”‚   API       â”‚     â”‚   API       â”‚
â”‚ Instance 1  â”‚     â”‚ Instance 2  â”‚     â”‚ Instance 3  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                   â”‚                   â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
                    â”‚ Load        â”‚
                    â”‚ Balancer    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
                    â”‚ PostgreSQL  â”‚
                    â”‚ (Primary)   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Caching Layer (Future)
```
API Instance
     â”‚
     â”œâ”€â”€> Redis Cache (Session, Frequently Accessed Data)
     â”‚
     â””â”€â”€> PostgreSQL (Persistent Data)
```

### Microservices Evolution (Future)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Auth      â”‚   â”‚   User      â”‚   â”‚   Product   â”‚
â”‚  Service    â”‚   â”‚  Service    â”‚   â”‚  Service    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                 â”‚                 â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
                  â”‚   Message   â”‚
                  â”‚    Queue    â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š Performance Considerations

### Database
- Connection pooling (10 idle, 100 max)
- Indexed columns (email, id)
- Prepared statements via GORM
- Pagination to limit result sets

### API
- Stateless design (JWT)
- Middleware caching potential
- Efficient JSON serialization
- Minimal memory allocations

### Security
- Bcrypt cost factor: 10 (balance security/performance)
- JWT validation: O(1) with proper secret
- Permission checks: In-memory after load

---

**Architecture Version: 1.0**
**Last Updated: November 2024**
